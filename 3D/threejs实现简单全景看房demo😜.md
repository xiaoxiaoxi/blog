# threejså®ç°ç®€å•å…¨æ™¯çœ‹æˆ¿demoğŸ˜œ

[![img](https://p9-passport.byteacctimg.com/img/user-avatar/e883ad00f4c080eae18ebdb3c35aa9d8~300x300.image)](https://juejin.cn/user/4274499823866622)

[åŠä¸ªç³¯ç±³é¸¡ ![lv-2](https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/f597b88d22ce5370bd94495780459040.svg)](https://juejin.cn/user/4274499823866622)

2021å¹´12æœˆ31æ—¥ 11:51 Â· é˜…è¯» 2532

å…³æ³¨

![threejså®ç°ç®€å•å…¨æ™¯çœ‹æˆ¿demoğŸ˜œ](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/847b4f4af48142959e50598ebca24092~tplv-k3u1fbpfcp-zoom-crop-mark:1304:1304:1304:734.awebp?)

å„ä½å¤§å®¶å¥½ğŸ˜Šï¼Œæœ€è¿‘ä¸€ç›´åœ¨å­¦ä¹  **threejs** ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ä¸æ–­è¿›æ­¥ï¼Œåœ¨å°†æ¥æˆ‘ä¼šä¸æ–­å®Œå–„æˆ‘çš„ **threejs** æ¡ˆä¾‹åº“ï¼Œå¸Œæœ›èƒ½åœ¨å­¦ä¹ è·¯ä¸Šå¸®åˆ°å¤§å®¶ğŸŒ¹

æ¥ä¸‹æ¥ä¸ºå„ä½ä»‹ç»çš„æ˜¯ä¸€ä¸ªå…¨æ™¯çœ‹æˆ¿çš„demoï¼Œæˆ‘ä»¬å…ˆä¸Šåœ°å€ï¼š

- æºç åœ°å€ï¼š[github.com/ljnMeow/360â€¦](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FljnMeow%2F360-house-viewing.git)
- é¢„è§ˆåœ°å€ï¼š[ljnmeow.github.io/360-house-vâ€¦](https://link.juejin.cn/?target=https%3A%2F%2Fljnmeow.github.io%2F360-house-viewing%2Fdist)
- å…¨æ™¯å›¾åˆ‡å‰²å·¥å…·ï¼š[matheowis.github.io/HDRI-to-Cubâ€¦](https://link.juejin.cn/?target=https%3A%2F%2Fmatheowis.github.io%2FHDRI-to-CubeMap%2F)

# å‰è¨€

**threejs** æ˜¯ **javascript** ç¼–å†™çš„ä¸€ä¸ª **WebGL** ç¬¬ä¸‰æ–¹åº“ã€‚åœ¨ **threejs** ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ **Scene(åœºæ™¯)** ã€ **Camera(ç›¸æœº)** å’Œ **Renderer(æ¸²æŸ“å™¨)** æ¥å®ç°ä¸€ä¸ª3dçš„åœºæ™¯ï¼Œç„¶åå¾€é‡Œé¢æ·»åŠ å„ç§å…‰æºã€ç‰©ä½“ç­‰ç­‰ï¼Œå½¢æˆä¸€ä¸ª3dä¸–ç•Œã€‚

## threejsæ”¯æŒç¨‹åº¦

å› ä¸º **threejs** æ˜¯åŸºäº **webgl** å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸»è¦çœ‹è®¾å¤‡æ˜¯å¦æ”¯æŒ **webgl** ã€‚æ®æˆ‘æ‰€çŸ¥ç›®å‰ä¸»æµæœ€æ–°ç‰ˆæœ¬çš„è®¾å¤‡ã€æµè§ˆå™¨éƒ½æ”¯æŒ **webgl**ï¼Œä½†å¦‚æœå®¢æœè¦åœ¨ä¸€äº›æ—©æœŸçš„è®¾å¤‡ä¸Šè·‘ï¼Œä¾‹å¦‚æŸäº›è¶…å¤§å±å¤§å±ç›‘æ§ç³»ç»Ÿï¼Œè·‘è¿™ä¸ªçš„è®¾å¤‡å¯èƒ½æ˜¯æ—©æœŸçš„ **IE** å¹¶ä¸”æ— æ³•å‡çº§ã€‚æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æƒè¡¡ä¸‹æ—©æœŸ **IE** å’Œ å®‰å“ã€è‹¹æœè®¾å¤‡æ˜¯å¦æ”¯æŒ **webgl**ï¼Œ è¯¦æƒ…å¯è§ä¸‹å›¾ï¼š

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/73c7afd6ff494c28b1618909952636fc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

# åŸºæœ¬ä»‹ç»

è¦å®ç°3då›¾å½¢çš„å±•ç¤ºï¼Œå¤§è‡´æ˜¯ä»¥ä¸‹æ€è·¯ï¼š

- åˆ›å»ºä¸‰ç»´åœºæ™¯(Scene)
- é€‰æ‹©è§†è§‰ç‚¹å¹¶ç¡®è®¤è§†è§‰ä½ç½®è§’åº¦(Camera)
- æ·»åŠ ç‰©ä½“ä¾›è§‚å¯Ÿ
- æ¸²æŸ“åœºæ™¯(Renderer)

## Scene

åœºæ™¯æ˜¯æˆ‘ä»¬æ‰€æœ‰ç‰©ä½“çš„å®¹å™¨ï¼Œé€šä¿—æ¥è®²å°±ç›¸å½“äºæˆ‘ä»¬çš„ä¸–ç•Œ

## Camera

ç›¸æœºæ˜¯æˆ‘ä»¬è¿™ä¸ªä¸–ç•Œçš„è§‚å¯Ÿè€…ï¼Œä½¿ç”¨å³æ‰‹åæ ‡ç³»å®šä½

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd8fb7ed0d554a7a9c726fc869acc52c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

**threejs** å¸¸ç”¨çš„ç›¸æœºæœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ **æ­£äº¤æŠ•å½±ç›¸æœº(OrthographicCamera)** å’Œ **é€è§†æŠ•å½±ç›¸æœº(PerspectiveCamera)** ï¼Œä¸‹é¢æ˜¯æˆ‘å¯¹è¿™ä¸¤ç§æ–¹å¼çš„ç†è§£ï¼Œé”™äº†è¯·å„ä½å¤§ä½¬æŒ‡ç‚¹æˆ‘ä¸€ä¸‹ğŸ¤

### æ­£äº¤æŠ•å½±ç›¸æœº(OrthographicCamera)

æ­£äº¤æŠ•å½±æ˜¯ä¸€ç§ç›¸å¯¹ç®€å•çš„æŠ•å½±æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¯¥æ¨¡å¼çœ‹ä½œçœ‹ä½œä¸€ä¸ªé•¿æ–¹å½¢çŸ©å½¢ï¼Œæ€»å…±æœ‰6ä¸ªé¢ã€‚è¯¥æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯æ— è®ºå‡ºäºçŸ©å½¢ä¸­çš„å“ªä¸ªä½ç½®ï¼Œå…¶æŠ•å½±çš„å¤§å°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé€šä¿—ç†è§£å°±æ˜¯è¯¥æ¨¡å¼è·Ÿå¸¸ç”Ÿæ´»ä¸­çš„è§†è§‰æ•ˆæœä¸ä¸€æ ·ã€‚æˆ‘ä»¬å¹³æ—¶çœ‹ç‰©ä½“æ˜¯è¿œå°è¿‘å¤§ï¼Œè€Œè¯¥æ¨¡å¼ä¸‹å±•ç¤ºçš„ç‰©ä½“æ— è®ºç‰©ä½“è·ç¦»ç›¸æœºè·ç¦»è¿œæˆ–è€…è¿‘ï¼Œåœ¨æœ€ç»ˆæ¸²æŸ“çš„å›¾ç‰‡ä¸­ç‰©ä½“çš„å¤§å°éƒ½ä¿æŒä¸å˜ã€‚é€šè¿‡ä¸‹é¢å›¾ç‰‡èƒ½æ¸…æ¥šçœ‹åˆ°ï¼Œç›¸æœºè§†è§‰ä¸­çš„ç‰©ä½“æŠ•æ”¾åˆ°è¿›å¹³é¢ï¼Œç„¶åè¿‘å¹³é¢ä¸­çš„ç‰©ä½“æ¸²æŸ“åˆ°è¿œå¹³é¢ä¹Ÿå°±æ˜¯å±å¹•ä¸­ï¼Œå¹¶ä¸”æ— è®ºæŠ•æ”¾åœ¨å“ªä¸€é¢ï¼Œç‰©ä½“çš„å¤§å°éƒ½ä¸å˜ã€‚

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee9400e7e1a64b7491b5aad97dbb6704~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

### é€è§†æŠ•å½±ç›¸æœº(PerspectiveCamera)

é€è§†æŠ•å½±çš„è§†è§‰æ•ˆæœå‘ˆç°ä¸€ä¸ªé”¥å½¢ï¼Œè¯¥æ¨¡å¼å°±æ˜¯æˆ‘ä»¬ç°å®ä¸–ç•Œä¸­çš„è§†è§‰ä½“ç°ã€‚è¯¥æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ç‰©ä½“è¿œå°è¿‘å¤§ã€‚

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/792dce4e31a14ab2bd0b5bb9026f3700~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

ç›¸æœºæ•ˆæœä½“éªŒåœ°å€åœ¨å®˜æ–¹demoä¸­æœ‰ï¼š[threejs.org/examples/#wâ€¦](https://link.juejin.cn/?target=https%3A%2F%2Fthreejs.org%2Fexamples%2F%23webgl_camera)

## Renderer

æ¸²æŸ“å™¨æ¸²æŸ“æˆ‘ä»¬ç²¾å¿ƒåˆ¶ä½œçš„åœºæ™¯

# è¿›å…¥æ­£é¢˜

æ ¹æ®æˆ‘çš„äº†è§£ç›®å‰å¸¸ç”¨äºå®ç°å…¨æ™¯çœ‹æˆ¿æ•ˆæœçš„æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ **å¤©ç©ºç›’(skyBox)** å’Œ **å…¨æ™¯å›¾ç‰‡è´´å›¾** ï¼Œæˆ‘è¿™ä¸ªdemoä½¿ç”¨çš„æ˜¯åè€…ã€‚

## å®ç°æ–¹å¼

### skyBox

**skyBox** æ–¹æ³•æ˜¯æœ€å®¹æ˜“ç†è§£çš„ï¼Œåœ¨æˆ‘ä»¬èº«å¤„çš„åœºæ™¯å†…ï¼Œæ— éå°±æ˜¯6ä¸ªé¢ï¼Œä¸Šä¸‹ã€å‰åã€å·¦å³ã€‚å°†è¿™6ä¸ªé¢çš„è§†è§‰å¤„ç†æˆå›¾ç‰‡å°±å¾—åˆ°6å¼ ä¸åŒæ–¹å‘è§†è§‰çš„å›¾ç‰‡ã€‚

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e143d8cea7f466ab4f2917116551a84~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

æˆ‘ä»¬å°†6ä¸ªè§†è§‰çš„å›¾ç‰‡è´´åˆ°ç«‹æ–¹ä½“çš„6ä¸ªé¢ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæˆ¿é—´ã€‚

```
initContent() {
  let picList = ["left", "right", "top", "bottom", "front", "back"];
  let boxGeometry = new THREE.BoxGeometry(10, 10, 10);
  let boxMaterials = [];
  picList.forEach((item) => {
    let texture = new THREE.TextureLoader().load(
      require(`@/assets/image/${item}.png`)
    );
    boxMaterials.push(new THREE.MeshBasicMaterial({ map: texture }));
  });
  this.box = new THREE.Mesh(boxGeometry, boxMaterials);
  this.scene.add(this.box);
},
å¤åˆ¶ä»£ç 
```

![å±å¹•å½•åˆ¶2021-12-30 ä¸‹åˆ11.00.31.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/77fed458999b4348bb1fb5bf5794cf27~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

å°†è§†è§‰ç§»åˆ°ç«‹æ–¹ä½“ä¸­å¿ƒï¼Œå¹¶è®©è´´å›¾å†…ç¿»è½¬ä¸€ä¸‹ï¼Œå°±èƒ½å®ç°å…¨æ™¯çœ‹æˆ¿

```
this.box.geometry.scale(10, 10, -10);
å¤åˆ¶ä»£ç 
```

![å±å¹•å½•åˆ¶2021-12-30 ä¸‹åˆ11.11.50.gif](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/183faf80bd05437fac28de39c99985f2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

### å…¨æ™¯å›¾è´´å›¾

å…¨æ™¯å›¾è´´å›¾è¿™ç§æ–¹å¼æˆ‘è®¤ä¸ºæ˜¯ç®€å•è€Œä¸”æ•ˆæœæœ€å¥½çš„ä¸€ç§ã€‚å†™ä¹‹å‰éœ€è¦ä¸€å¼ å…¨æ™¯å›¾ç‰‡ï¼Œè¿™ä¸ªç”¨å•åçš„å…¨æ™¯æ¨¡å¼å°±èƒ½æ‹ä¸€å¼ 

![livingRoom.jpg](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d07d7698264f42028dc226077995faae~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

**threejs** æ·»åŠ ä¸€ä¸ªçƒä½“ã€‚å¹¶æŠŠå…¨æ™¯å›¾ä½œä¸ºè´´å›¾è´´åˆ°çƒä½“ä¸Šï¼Œå¾—åˆ°çš„æ•ˆæœå¦‚ä¸‹ï¼š

```
initContent() {
  let sphereGeometry = new THREE.SphereGeometry(16, 50, 50);
  let texture = new THREE.TextureLoader().load(require("@/assets/image/livingRoom.jpg"));
  let sphereMaterial = new THREE.MeshBasicMaterial({ map: texture });
  this.sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
  this.scene.add(this.sphere);
},
å¤åˆ¶ä»£ç 
```

![è½»æ˜ å½•å±-2021-12-31-10-11-37.gif](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fcb9b952fe3449d29b8f552b744eaf55~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

åŒæ ·ï¼ŒæŠŠè§†è§‰æ”¾çƒå†…ï¼Œè´´å›¾åè½¬ã€‚

```
sphereGeometry.scale(16, 16, -16);
å¤åˆ¶ä»£ç 
```

![è½»æ˜ å½•å±-2021-12-31-10-20-58.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8178cb958117495f858b5ef385968ed3~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

## æ·»åŠ æ ‡ç­¾

æˆ‘ä»¬ç°åœ¨å·²ç»å®ç°å…¨æ™¯çœ‹æˆ¿äº†ï¼Œæ¥ä¸‹æ¥ç»™ä¸€äº›ç‰©ä½“æ·»åŠ è¯´æ˜æ ‡ç­¾ï¼Œæˆ‘è¿™è¾¹çš„æ ‡ç­¾åˆ†ä¸¤ç§ï¼Œä¸€ç§ç‚¹å‡»èƒ½å¤Ÿè¿›å…¥ä¸‹ä¸€ä¸ªæˆ¿é—´ï¼Œä¸€ç§æ˜¯å¼¹å‡ºä¿¡æ¯æ¡†ã€‚å…ˆçœ‹æ•ˆæœï¼š

![è½»æ˜ å½•å±-2021-12-31-10-32-16.gif](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b48465811db345dd9aa12bb3ff7a239d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

ä¸‹é¢çœ‹çœ‹æˆ‘çš„æ•°æ®ç»“æ„

```
dataList: [
    {
        image: require("@/assets/image/livingRoom.jpg"), // åœºæ™¯è´´å›¾
        tipsList: [ // æ ‡ç­¾æ•°æ®
            {
                position: { x: -200, y: -4, z: -147 }, // æ ‡ç­¾ä½ç½®
                content: { // æ ‡ç­¾å†…å®¹
                    title: "è¿›å…¥å¨æˆ¿", // æ ‡é¢˜
                    text: "", // æ–‡æœ¬å†…å®¹
                    image: 1, // åœºæ™¯è´´å›¾çš„ä¸‹æ ‡ï¼Œå¯¹åº”dataListä¸‹æ ‡
                    showTip: false, // æ˜¯å¦å±•ç¤ºå¼¹å‡ºæ¡†
                    showTitle: true, // æ˜¯å¦å±•ç¤ºæç¤ºæ ‡é¢˜
                },
            },
            {
                position: { x: -100, y: 0, z: -231 },
                content: {
                    title: "ä¿¡æ¯ç‚¹2",
                    text: "77989",
                    showTip: true,
                    showTitle: false,
                },
            },
            {
                position: { x: 150, y: -50, z: -198 },
                content: {
                    title: "ä¿¡æ¯ç‚¹3",
                    text: "qwdcz",
                    showTip: true,
                    showTitle: false,
                },
            },
            {
                position: { x: 210, y: 11, z: -140 },
                content: {
                    title: "ä¿¡æ¯ç‚¹4",
                    text: "å¤§è±†é£Ÿå¿ƒè™«ä¾¦å¯Ÿåå¤§å¤§è‹æ‰“å¤§å¤§å¤§å¤§å¤§å¤§å¤§",
                    showTip: true,
                    showTitle: false,
                },
            },
            {
                position: { x: 208, y: -12, z: 140 },
                content: {
                    title: "ä¿¡æ¯ç‚¹5",
                    text: "eq",
                    showTip: true,
                    showTitle: false,
                },
            },
            {
                position: { x: 86, y: -9, z: 236 },
                content: {
                    title: "è¿›å…¥æˆ¿é—´",
                    text: "",
                    showTip: false,
                    showTitle: true,
                },
            },
        ],
    },
    {
        image: require("@/assets/image/kitchen.jpg"),
        tipsList: [
            {
                position: { x: -199, y: -24, z: 145 },
                content: {
                    title: "è¿›å…¥å¤§å…",
                    text: "",
                    image: 0,
                    showTip: false,
                    showTitle: true,
                },
            },
        ],
    },
],
å¤åˆ¶ä»£ç 
```

å¾€åœºæ™¯ä¸­æ·»åŠ æ ‡ç­¾ï¼Œå¾—åˆ°å¦‚ä¸‹æ•ˆæœã€‚

```
addTipsSprite(index = 0) {
  let tipTexture = new THREE.TextureLoader().load(
    require("@/assets/image/tip.png")
  );
  let material = new THREE.SpriteMaterial({ map: tipTexture });
  this.tipsSpriteList = [];
  this.dataList[index].tipsList.forEach((item) => {
    let sprite = new THREE.Sprite(material);
    sprite.scale.set(10, 10, 10);
    sprite.position.set(item.position.x, item.position.y, item.position.z); // è®¾ç½®æ ‡ç­¾ä½ç½®
    sprite.content = item.content; // è®¾ç½®æ ‡ç­¾å†…å®¹
    this.tipsSpriteList.push(sprite); // å‚¨å­˜æ ‡ç­¾
    this.scene.add(sprite); // æ·»åŠ åˆ°åœºæ™¯ä¸­
  });
},
å¤åˆ¶ä»£ç 
```

![è½»æ˜ å½•å±-2021-12-31-10-52-05.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/346e25b0db2946239a2df5973497e21a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

æ¥ä¸‹æ¥å®ç°é¼ æ ‡ç§»å…¥ï¼Œå†…å®¹å¼¹å‡ºæ•ˆæœ

```
// html
<div class="tooltip-box" :style="tooltipPosition" ref="tooltipBox">
  <div class="container">
    <div class="title">æ ‡é¢˜ï¼š{{ tooltopContent.title }}</div>
    <div class="explain">è¯´æ˜ï¼š{{ tooltopContent.text }}</div>
  </div>
</div>
<p class="title-text" ref="titleBox" :style="titlePosition">
  {{ tooltopContent.title }}
</p>
å¤åˆ¶ä»£ç 
// data
tooltipPosition: { // åˆå§‹åŒ–ä½ç½®å…¨éƒ¨åœ¨å±å¹•ä¹‹å¤–
    top: "-100%",
    left: "-100%",
},
titlePosition: {
    top: "-100%",
    left: "-100%",
},
tooltopContent: {}, // å±•ç¤ºçš„å†…å®¹
å¤åˆ¶ä»£ç 
// method
onMousemove(e) {
  e.preventDefault();
  let element = this.$refs.threeDBox;
  let raycaster = new THREE.Raycaster();
  let mouse = new THREE.Vector2();
  // é€šè¿‡é¼ æ ‡ç‚¹å‡»çš„ä½ç½®è®¡ç®—å‡ºraycasteræ‰€éœ€è¦çš„ç‚¹çš„ä½ç½®ï¼Œä»¥å±å¹•ä¸­å¿ƒä¸ºåŸç‚¹ï¼Œå€¼çš„èŒƒå›´ä¸º-1åˆ°1.
  mouse.x = (e.clientX / element.clientWidth) * 2 - 1;
  mouse.y = -(e.clientY / element.clientHeight) * 2 + 1;
  raycaster.setFromCamera(mouse, this.camera);
  // å°†æ ‡ç­¾ç²¾çµæ•°æ®æ”¾è¿›æ¥åšè§†çº¿äº¤äº’
  let intersects = raycaster.intersectObjects(this.tipsSpriteList, true); 
  // è§†çº¿ç©¿è¿‡é›†åˆé€‰æ‹©æœ€å‰é¢çš„ä¸€ä¸ª
  if (intersects.length > 0) {
    // å°†æ ‡ç­¾çš„ç©ºé—´åæ ‡è½¬å±å¹•åæ ‡ï¼Œé€šè¿‡è®¡ç®—èµ‹ç»™å…ƒç´ çš„topã€left
    let elementWidth = element.clientWidth / 2;
    let elementHeight = element.clientHeight / 2;
    let worldVector = new THREE.Vector3(
      intersects[0].object.position.x,
      intersects[0].object.position.y,
      intersects[0].object.position.z
    );
    let position = worldVector.project(this.camera);
    this.tooltopContent = intersects[0].object.content;
    if (intersects[0].object.content.showTip) {
      let left = Math.round(
        elementWidth * position.x +
          elementWidth -
          this.$refs.tooltipBox.clientWidth / 2
      );
      let top = Math.round(
        -elementHeight * position.y +
          elementHeight -
          this.$refs.tooltipBox.clientHeight / 2
      );
      this.tooltipPosition = {
        left: `${left}px`,
        top: `${top}px`,
      };
    } else if (intersects[0].object.content.showTitle) {
      let left = Math.round(
        elementWidth * position.x +
          elementWidth -
          this.$refs.titleBox.clientWidth / 2
      );
      let top = Math.round(-elementHeight * position.y + elementHeight);
      this.titlePosition = {
        left: `${left}px`,
        top: `${top}px`,
      };
    }
  } else {
    // é¼ æ ‡ç§»å‡ºå»éšè—æ‰€æœ‰
    this.handleTooltipHide(e);
  }
},
handleTooltipHide(e) {
  e.preventDefault();
  this.tooltipPosition = {
    top: "-100%",
    left: "-100%",
  };
  this.titlePosition = {
    top: "-100%",
    left: "-100%",
  };
  this.tooltopContent = {};
},
å¤åˆ¶ä»£ç 
// mounted
this.renderer.domElement.addEventListener(
  "mousemove",
  this.onMousemove,
  false
);
this.$refs.tooltipBox.addEventListener(
  "mouseleave",
  this.handleTooltipHide,
  false
);
å¤åˆ¶ä»£ç 
```

æœ€ç»ˆå¾—åˆ°æ•ˆæœï¼š

![è½»æ˜ å½•å±-2021-12-31-11-08-13.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa07d85bcd9f4053992e977e01f3cad1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

## åœºæ™¯åˆ‡æ¢

å…¨æ™¯çœ‹æˆ¿æ€»ä¸èƒ½ä¸€ç›´çœ‹ä¸€ä¸ªæˆ¿é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å®ç°ç‚¹å‡»åˆ‡æ¢åœºæ™¯åŠŸèƒ½ã€‚ç›´æ¥codeing...

```
changeContentAndtips(index) {
  // æ¸…é™¤åœºæ™¯æ•°æ®å†…æ‰€æœ‰çš„ç²¾çµæ ‡ç­¾
  this.scene.children = this.scene.children.filter(
    (item) => String(item.type) !== "Sprite"
  );
  // å‚¨å­˜æ•°ç»„ç½®ç©º
  this.tipsSpriteList = [];
  // é‡æ–°åŠ è½½è´´å›¾ï¼Œè¿™è¾¹åº”ç”¨gaspåšä¸€ä¸ªç®€å•çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œå°†é€æ˜åº¦ä»0 ~ 1
  let texture = new THREE.TextureLoader().load(this.dataList[index].image);
  let sphereMaterial = new THREE.MeshBasicMaterial({
    map: texture,
    transparent: true,
    opacity: 0,
  });
  this.sphere.material = sphereMaterial;
  gsap.to(sphereMaterial, { transparent: true, opacity: 1, duration: 2 });
  // æ‰‹åŠ¨æ›´æ–°æŠ•å½±çŸ©é˜µ
  this.camera.updateProjectionMatrix();
  // æ·»åŠ å½“å‰åœºæ™¯æ ‡ç­¾
  this.addTipsSprite(index);
},
onMouseClick(e) {
  e.preventDefault();
  let element = this.$refs.threeDBox;
  let raycaster = new THREE.Raycaster();
  let mouse = new THREE.Vector2();
  mouse.x = (e.clientX / element.clientWidth) * 2 - 1;
  mouse.y = -(e.clientY / element.clientHeight) * 2 + 1;
  raycaster.setFromCamera(mouse, this.camera);
  let intersects = raycaster.intersectObjects(this.tipsSpriteList, true);
  if (intersects.length > 0 && intersects[0].object.content.showTitle) {
    this.changeContentAndtips(intersects[0].object.content.image);
    this.handleTooltipHide(e);
  }
},
å¤åˆ¶ä»£ç 
```

æœ€ç»ˆå¾—åˆ°å®Œæ•´æ•ˆæœå¦‚ä¸‹å›¾ï¼š

![è½»æ˜ å½•å±-2021-12-31-11-18-19.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af5ec22cb36043b0973bc095df78c8d7~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)

# æ€»ç»“

åœ¨è¿™ä¸ªdemoä¸­æœ‰ä¸€äº›ç»†èŠ‚é—®é¢˜æˆ‘å¤„ç†çš„ä¸æ˜¯å¾ˆå¥½ï¼Œä¾‹å¦‚åŠ è½½æ—¶å› ä¸ºè´´å›¾åŠ è½½æ…¢é»‘å±(è¿™æ˜¯å› ä¸ºè´´å›¾å¤ªå¤§ï¼Œä¼˜åŒ–æ—¶å¯åŠ å…¥ç­‰å¾…åŠ¨ç”»)ï¼Œè¿˜æœ‰å°±æ˜¯åŠ è½½é¡ºåºæ²¡å¤„ç†å¥½ï¼Œåœºæ™¯è´´å›¾è¿˜æ²¡åŠ è½½å®Œæ ‡ç­¾å·²ç»è¿›æ¥äº†ã€‚

åœ¨ä¸æ–­å­¦ä¹  **threejs** çš„è¿‡ç¨‹ä¸­ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºæœ‰è¶£ï¼Œçœ‹ç€åˆ«äººç‚«é…·çš„3Dæ•ˆæœå’Œæ™ºæ…§åŸå¸‚æ„Ÿè§‰å¥½å¼ºï¼Œä¹Ÿæ„Ÿåˆ°è‡ªå·±çš„ä¸è¶³ã€‚è¶ç€è¿™æ®µæ—¶é—´å…¬å¸æœ‰é¡¹ç›®éœ€è¦ç”¨ **threejs** èƒ½å¤Ÿå…‰æ˜æ­£å¤§æ‘¸é±¼å­¦ä¹ ï¼ŒåŠªåŠ›å†²å•ŠğŸ’ª

æœ€åå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åˆ°å„ä½â¤ä»Šå¤©æ˜¯2021æœ€åä¸€å¤©ï¼Œç¥å„ä½å¤§ä½¬ä»Šå¤©æ‘¸é±¼ï¼Œæ˜å¹´å¹´å¹´æœ‰ä½™ğŸ˜