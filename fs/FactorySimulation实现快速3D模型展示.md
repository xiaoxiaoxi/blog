# FactorySimulation在Player中实现快速三维模型展示

当建模人员使用FactorySimulation的时候，通常会将注意力集中在建模功能本身，专注与静态模型与动态业务逻辑的设定，FactorySimulation的建模器可以帮助建模人员完成此项工作，通过2维对象的拖放、属性设置以及函数的设定完成整个业务逻辑的建模。

与此同时，最终客户往往希望能看到一些三维的展示效果，但是产线仿真的建模人员通常并不是3D模型的建模人员与动画制作方面的熟练开发人员，所以FactorySimulation的Player为此提供了快速三维模型转换功能来方便仿真建模人员进行三维模型的展示。

快速三维模型的展示是帮助建模人员快速的建立三维模型，同时由于模型本身是可能随时调整的，所以整个3D模型应该是动态可以随着FS模型变化而动态变换的，整个三维模型是通过FS模型数据计算得到，而非建立一个大型的固定的三维模型（例如Unity程序），当建模者增加或减少对象的时候，三维模型会实时计算出当前场景而增减对象；三维模型的整体的运行业务逻辑同样也是通过FS的离散事件系统（DES）进行控制，动态变化，当建模人员修改了FS中的业务逻辑，则三维模型会根据变化后产生的事件进行渲染，而无需建模人员再次编写相应的业务逻辑。

这里我们可以先来看几个简单的案例。

## AGV 模型三维展示
我们以FS的案例中的AGV模型为例，当你点击 Player 按钮的时候：
> 1. 系统会根据当前FS模型中的设定，完成三维模型的构建，同时会根据系统中设定 AGV 数量动态生成相应的 AGV，并排队等待任务进行处理。
> 2. 后台FS计算得到具体的任务信息并发送到三维模型中，三维模型根据事件模型进行实时渲染绘制
> 3. 三维模型根据自身的动画代码会控制 AGV 满载或空载、设备对工件的加工等动画展示。

[3D_AGV](3D_AGV.gif)



## 产线模型阻塞逻辑三维展示
在2.5.0的FS版本中我们增加了产线阻塞逻辑，则三维展示也需要展现相同的特性：
> 当产线出口被阻塞，例如等待加工，产线上的工件会被阻塞，多个出口则可能会出现非常复杂的阻塞模型，FS会根据模型在后台计算得到阻塞事件与解除阻塞事件。
>
> 前端三维模型负责解释这些事件，根据阻塞和解除阻塞完成三维产线上工件的动画绘制。如下图所示：

[3D_ConveyorLine2](3D_ConveyorLine2.gif)




## 一个复杂产线模型的三维展示
这里我们展示的是FS案例中比较复杂的一个产线模型，该模型中，除了前面案例的AGV、产线动画等内容，三维部分还需要完成：
> 1. 参数化建模，例如多层立体货架需要根据货架的层数、列数等参数设定来绘制当前的货架。
> 2. 机械臂运动控制，FS提供对象的事件，但是前端需要根据事件绘制相应的动画，这里根据机械臂需要达到的点，通过逆运动学结算当前机械臂的运动动画
> 3. 报表数据展示，通过FS模型中设定的报表内容，在三维界面中绘制出报表内容并实时展示当前的数据。 我们通过加快执行仿真速度，来加速看到当前报表数据。

[3D_ProductionLine](3D_ProductionLine.gif)

